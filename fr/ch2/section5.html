<!DOCTYPE HTML>
<html lang="fr" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Solaris | Étude et Implémentation de LDAP Sécurisé</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.2.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../ch2/section6.html" />
    
    
    <link rel="prev" href="../ch2/section4.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="2.5" data-basepath=".." data-revision="Sat Aug 15 2015 14:44:01 GMT+0200 (CEST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Tapez pour rechercher" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="ch1/index.html">
            
                
                    <a href="../ch1/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Généralités sur le standard LDAP
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="ch1/section1.html">
            
                
                    <a href="../ch1/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Le service d&#39;annuaire
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="ch1/section2.html">
            
                
                    <a href="../ch1/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Le standard
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="ch1/section3.html">
            
                
                    <a href="../ch1/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Le protocole
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="ch1/section4.html">
            
                
                    <a href="../ch1/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Les modèles
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="ch1/section5.html">
            
                
                    <a href="../ch1/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Le format d&#39;échange
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="ch2/index.html">
            
                
                    <a href="../ch2/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Mise en oeuvre
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="ch2/index.html">
            
                
                    <a href="../ch2/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Contexte
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="ch2/section2.html">
            
                
                    <a href="../ch2/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        OpenLDAP
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="ch2/section3.html">
            
                
                    <a href="../ch2/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Configuration du serveur
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="ch2/section4.html">
            
                
                    <a href="../ch2/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Tru64
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.5" data-path="ch2/section5.html">
            
                
                    <a href="../ch2/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Solaris
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="ch2/section6.html">
            
                
                    <a href="../ch2/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Linux
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="ch2/section7.html">
            
                
                    <a href="../ch2/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        Performance
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="ch3/index.html">
            
                
                    <a href="../ch3/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Authentification LDAP
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="ch3/section1.html">
            
                
                    <a href="../ch3/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Auth. et centralisation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="ch3/section2.html">
            
                
                    <a href="../ch3/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Solaris
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="ch3/section3.html">
            
                
                    <a href="../ch3/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Linux
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="ch3/section4.html">
            
                
                    <a href="../ch3/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Tru64
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="ch3/section5.html">
            
                
                    <a href="../ch3/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Plusieurs home
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="ch3/section6.html">
            
                
                    <a href="../ch3/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Récapitulatif
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="ch4/index.html">
            
                
                    <a href="../ch4/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        LDAP sécurisé
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="ch4/section1.html">
            
                
                    <a href="../ch4/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Authentification SSL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="ch4/section2.html">
            
                
                    <a href="../ch4/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Certificats
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="ch4/section3.html">
            
                
                    <a href="../ch4/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        OpenLDAP et SSL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="ch4/section4.html">
            
                
                    <a href="../ch4/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Linux
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="ch4/section5.html">
            
                
                    <a href="../ch4/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Solaris
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="ch4/section6.html">
            
                
                    <a href="../ch4/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Tru64 v5.1
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="ch4/section7.html">
            
                
                    <a href="../ch4/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Tru64 v5.0
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="ch4/section8.html">
            
                
                    <a href="../ch4/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                        Messages LDAP
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="ch4/section9.html">
            
                
                    <a href="../ch4/section9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                        ACL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="ch4/section10.html">
            
                
                    <a href="../ch4/section10.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.10.</b>
                        
                        Mots de passe
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="ch5/index.html">
            
                
                    <a href="../ch5/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Le protocole Kerberos
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="ch5/section1.html">
            
                
                    <a href="../ch5/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Présentation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="ch5/section2.html">
            
                
                    <a href="../ch5/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Fonctionnement
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="ch5/section3.html">
            
                
                    <a href="../ch5/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Mise en oeuvre
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="conclusion.html">
            
                
                    <a href="../conclusion.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Conclusion
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="code.html">
            
                
                    <a href="../code.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Fichiers de configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="glossaire.html">
            
                
                    <a href="../glossaire.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Glossaire
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="bibliographie.html">
            
                
                    <a href="../bibliographie.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Bibliographie
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="abstract.html">
            
                
                    <a href="../abstract.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Abstract
                    </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Publié avec GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table des matières"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Recherche"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Paramètres de Police"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">Clair</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sépia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Nuit</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Partage"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Partager sur Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Partager sur Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Partager sur Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Partager sur Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Partager sur Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Étude et Implémentation de LDAP Sécurisé</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="2-5-configuration-du-client-solaris-8">2.5 Configuration du client Solaris 8</h2>
<p>Dans cette section, il est question de configurer le syste&#x300;me Solaris de Sun installe&#x301; sur la machine sunray1v440 (voir <a href="">figure 2.1</a>).</p>
<h3 id="2-5-1-les-fichiers-de-configuration">2.5.1 Les fichiers de configuration</h3>
<p>Sous Solaris 8 les fichiers <code>/var/ldap/ldap_client_file</code> et <code>ldap_client_cred</code> sont utilise&#x301;s pour configurer le client LDAP. Ces deux fichiers ne doivent pas e&#x302;tre modifie&#x301;s manuellement mais par l&#x2019;interme&#x301;diaire de la commande <em>ldapclient</em>. En effet, Sun ne garantit pas que le contenu de ces fichiers soit toujours humainement compre&#x301;hensible.</p>
<p>Le fichier <code>ldap_client_file</code> contient la configurations du client tandis que fichier <code>ldap_client_cred</code> contient des informations dont le client se sert pour se connecter au serveur. Les parame&#x300;tres les plus importants de ces fichiers sont repris aux tableaux <a href="">2.6</a> et <a href="">2.7</a>.</p>
<table>
<thead>
<tr>
<th>attribut</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NS_LDAP_FILE_VERSION</td>
<td>Nume&#x301;ro de version du fichier de configuration.</td>
</tr>
<tr>
<td>NS_LDAP_SERVERS</td>
<td>Adresse IP et nume&#x301;ro de port du serveur LDAP a&#x300; contacter.</td>
</tr>
<tr>
<td>NS_LDAP_SEARCH_BASEDN</td>
<td>Noeud de base par de&#x301;faut a&#x300; partir duquel le client effectue ses recherches dans l&#x2019;an- nuaire.</td>
</tr>
<tr>
<td>NS_LDAP_SERVICE_SEARCH_DESC</td>
<td>Rede&#x301;finit le DN de base pour un service particulier.</td>
</tr>
<tr>
<td>NS_LDAP_CREDENTIAL_LEVEL</td>
<td>Niveau d&#x2019;identification que le client utilise pour se connecter au serveur (anonymous ou proxy).</td>
</tr>
<tr>
<td>NS_LDAP_AUTH</td>
<td>De&#x301;finit la me&#x301;thode d&#x2019;authentification par de&#x301;faut du client : aucune, simple ou se&#x301;curise&#x301;e (SSL/TLS, SASL...).</td>
</tr>
<tr>
<td>NS_LDAP_SERVICE_AUTH_METHODE</td>
<td>Rede&#x301;finit la me&#x301;thode d&#x2019;authentification pour un service.</td>
</tr>
<tr>
<td>NS_LDAP_CACHETTL</td>
<td>Spe&#x301;cifie la dure&#x301;e de validite&#x301; du cache client.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Tab. 2.6 &#x2013; Attributs du fichier ldap_client_file</p>
</blockquote>
<table>
<thead>
<tr>
<th>attribut</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NS_LDAP_BINDDN</td>
<td>DN utilise&#x301; par le client pour s&#x2019;identifier sur le serveur.</td>
</tr>
<tr>
<td>NS_LDAP_BINDPASSWD</td>
<td>Mot de passe utilise&#x301; lors de la connexion.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Tab. 2.7 &#x2013; Attributs du fichier ldap_client_cred</p>
</blockquote>
<h3 id="2-5-2-adapter-le-serveur-openldap">2.5.2 Adapter le serveur OpenLDAP</h3>
<p>Avant de pouvoir configurer le client Solaris 8, il faut effectuer quelques manipulations sur le serveur OpenLDAP. En effet, le client Solaris utilise des classes d&#x2019;objet qui ne sont pas fournies pas de&#x301;faut avec le serveur OpenLDAP. Ainsi, pour e&#x302;tre en mesure de re&#x301;pondre aux reque&#x302;tes du client Solaris, le sche&#x301;ma de l&#x2019;annuaire doit e&#x302;tre e&#x301;tendu en installant les fichiers <code>solaris.schema</code> et <code>DUAConfSchemaOID.schema</code> sur le serveur.</p>
<p>Le premier fichier (<code>solaris.schema</code>) contient les de&#x301;finitions de classes utilise&#x301;es pour enregistrer le profile du client Solaris (voir <a href="">Initialisation avec profile</a>) dans l&#x2019;annuaire. Quant au fichier <code>DUAConfSchemaOID.schema</code>, il de&#x301;finit la classe <em>DUAConfigProfile</em> utilise&#x301;e pour stocker le profile d&#x2019;un utilisateur particulier : le Directory User Agent (DUA). Ce dernier fait partie des composants d&#x2019;un annuaire de&#x301;finit par la nome X.500. Concre&#x300;tement, le DUA repre&#x301;sente l&#x2019;application cliente qui communique avec le serveur et acce&#x300;de a&#x300; l&#x2019;annuaire.</p>
<p>En plus de nouvelles classes, l&#x2019;annuaire doit avoir une structure adapte&#x301;e au client Solaris. Pour cela, l&#x2019;entre&#x301;e racine de l&#x2019;annuaire doit e&#x302;tre un objet de type nisDomainObject (de&#x301;finit dans le sche&#x301;ma <code>solaris.schema</code>). Cette classe de&#x301;finit l&#x2019;attribut <em>nisDomain</em>. Ce dernier est un concept propre au protocole NIS<sup><a href="#fn_9" id="reffn_9">9</a></sup> (<em>Network Information Service</em>) mais est encore utilise&#x301; par le client LDAP de Solaris pour ve&#x301;rifier le context de nommage du serveur lors de l&#x2019;initialisation du syste&#x300;me et du rafrai&#x302;chissement du profile du client.</p>
<p>Enfin, le DIT est modifie&#x301; afin de cre&#x301;er de nouvelles branches dans l&#x2019;arborescence de l&#x2019;annuaire. En effet, le client Solaris attend une certain organisation de l&#x2019;annuaire. Ces nouvelles branches ou <em>conteneurs</em> sont destine&#x301;s a&#x300; recevoir diffe&#x301;rents types d&#x2019;informations comme les profiles clients, les comptes utilisateurs, les groupes, etc. Les diffe&#x301;rentes e&#x301;tapes pour adapter le serveur sont reprises ci-dessous.</p>
<ol>
<li><p>Ajouter les sche&#x301;mas <code>solaris.schema</code> et <code>DUAConfSchemaOID.schema</code> (repris <a href="">en annexe</a>) dans le re&#x301;pertoire contenant les fichiers de sche&#x301;mas du serveur (<code>/user/internet/openldap/etc/schema/</code>).</p>
</li>
<li><p>Modifier le fichier slapd.conf pour inclure les nouveaux sche&#x301;mas.</p>
<pre><code>include /usr/internet/openldap/etc/schema/solaris.schema
include      /usr/internet/openldap/etc/schema/DUAConfSchemaOID.schema
</code></pre></li>
<li><p>Remplacer l&#x2019;entre&#x301;e racine de l&#x2019;annuaire par une entre&#x301;e <em>nisDomainObject</em></p>
<ul>
<li>Supprimer le DIT actuel avec un client graphique ou en ligne de commande.</li>
</ul>
<pre><code>ldapdelete -D cn=root,dc=inpres,dc=be -x -W ou=accounts,dc=inpres,dc=be
ldapdelete -D cn=root,dc=inpres,dc=be -x -W ou=groups,dc=inpres,dc=be
ldapdelete -D cn=root,dc=inpres,dc=be -x -W dc=inpres,dc=be
</code></pre><ul>
<li>Ajouter l&#x2019;entre&#x301;e nisDomainObject a&#x300; la base de l&#x2019;annuaire.</li>
</ul>
<p><code>ldapadd -x -W -D cn=root,dc=inpres,dc=be -f baseDIT.LDIF</code></p>
<p> La commande ldapadd va se connecter en tant qu&#x2019;administrateur et ajouter l&#x2019;entre&#x301;e contenue dans le fichier <a href="">baseDN.LDIF</a>.</p>
</li>
<li><p>Cre&#x301;er l&#x2019;arborescence de l&#x2019;annuaire spe&#x301;cifique au client Solaris</p>
<pre><code>ldapadd -x -W -D cn=root,dc=inpres,dc=be -f DITSolaris.LDIF
</code></pre><p>Le fichier DITSolaris.LDIF (en <a href="">annexes</a>) contient les entre&#x301;es attendues par le client Solaris.</p>
</li>
</ol>
<h3 id="2-5-3-initialisation-du-client">2.5.3 Initialisation du client</h3>
<p>La commande <em>ldapclient</em> est utilise&#x301;e pour configurer le client LDAP, afficher la confi- guration actuelle et restaurer l&#x2019;environnement re&#x301;seau du client LDAP. Sous Solaris, il existe deux manie&#x300;res de configurer le client avec <em>ldapclient</em> :</p>
<ul>
<li>Re&#x301;cupe&#x301;rer un profile client stocke&#x301; dans l&#x2019;annuaire.</li>
<li>Cre&#x301;er manuellement les fichiers de configuration.</li>
</ul>
<h3 id="2-5-4-initialisation-avec-profile">2.5.4 Initialisation avec profile</h3>
<p>Pour faciliter la configuration du client Solaris, il est possible de de&#x301;finir un profile client stocke&#x301; dans l&#x2019;annuaire LDAP. Lors de l&#x2019;initialisation du client, le profile est charge&#x301; depuis l&#x2019;annuaire et utilise&#x301; pour initialiser les fichiers de configuration (<code>ldap_client_file</code> et <code>ldap_client_cred</code>).</p>
<p>L&#x2019;avantage de travailler avec un profile est de pouvoir modifier dynamiquement la configuration de tous les clients utilisant le me&#x302;me profile. Pour cela, le de&#x301;mon <em>ldap_cachemgr</em> doit e&#x302;tre lance&#x301; sur les clients. En effet, c&#x2019;est lui qui est charge&#x301; de mettre en cache le profile du client. Avant de pourvoir configurer le client avec un profile, il faut le cre&#x301;er a&#x300; l&#x2019;aide de la commande <em>ldap_gen_profile</em>.</p>
<pre><code class="lang-apache"><span class="hljs-keyword">ldap_gen_profile</span> -b dc=inpres,dc=be -a none -c anonymous 10.59.4.8 &gt; default

<span class="hljs-keyword">cat</span> default

<span class="hljs-keyword">dn</span>: cn=default,ou=profile,dc=inpres,dc=be
<span class="hljs-keyword">ObjectClass</span>: top
<span class="hljs-keyword">ObjectClass</span>: DUAConfigProfile
<span class="hljs-keyword">defaultServerList</span>: 10.59.4.8
<span class="hljs-keyword">defaultSearchBase</span>: dc=inpres,dc=be 
<span class="hljs-keyword">authenticationMethod</span>: none
<span class="hljs-keyword">cn</span>: default
<span class="hljs-keyword">credentialLevel</span>: anonymous
</code></pre>
<p>Une fois cre&#x301;e&#x301;, le profile doit e&#x302;tre place&#x301; dans le conteneur (branche ou=profile) destine&#x301; aux profiles cre&#x301;e&#x301;s au <a href="">paragraphe 2.5.2</a>.</p>
<pre><code class="lang-apache"><span class="hljs-keyword">ldapadd</span> -D cn=root,dc=inpres,dc=be -h 10.59.4.8 -f default
<span class="hljs-keyword">Bind</span> Password:

<span class="hljs-keyword">adding</span> new entry cn=default,ou=profile,dc=inpres,dc=be
</code></pre>
<p>Enfin, le client est initialise&#x301; avec le profile re&#x301;cupe&#x301;re&#x301; avec la commande <code>ldapclient -P</code>.</p>
<pre><code>ldapclient -P default 10.59.4.8
</code></pre><p>La figure 2.4 reprend les diffe&#x301;rentes e&#x301;tapes de l&#x2019;initialisation du client.</p>
<p><img src="../images/image_2.4.png" alt="Fig. 2.4 &#x2013; Initialisation du client avec un profile"></p>
<blockquote>
<p>Fig. 2.4 &#x2013; Initialisation du client avec un profile</p>
</blockquote>
<p>Pour initialiser le client LDAP, la commande <em>ldapclient</em> se connecte anonymement sur le serveur dont l&#x2019;adresse est passe&#x301;e en argument. Elle ve&#x301;rifie que la valeur de l&#x2019;attribut <em>nisdomain</em> de l&#x2019;entre&#x301;e <em>nisDomainObject</em> correspond au domaine du client. Si l&#x2019;annuaire est de&#x301;finit pour le domaine du client, le profile dont le nom a e&#x301;te&#x301; fournit a&#x300; ldapclient (dans l&#x2019;exemple <em>default</em>) est utilise&#x301; pour cre&#x301;er les fichier <code>/var/ldap/ldap_client_file</code> et <code>ldap_client_cred</code>. La commande ldapclient va e&#x301;galement mettre a&#x300; jour le fichier nsswitch.conf (voir <a href="">Chapitre 3</a>)</p>
<h1 id="2-5-5-le-d%C3%A9mon-ldap-cachemgr">2.5.5 Le d&#xE9;mon ldap_cachemgr</h1>
<p>Le de&#x301;mon <em>ldap_cachemgr</em> (sous le re&#x301;pertoire <code>/usr/lib/ldap/</code>) est un processus qui permet une mise en cache de la configuration du client. La figure 2.5 montre l&#x2019;interaction entre le client et le de&#x301;mon.</p>
<p><img src="../images/image_2.5.png" alt="Fig. 2.5 &#x2013; Le de&#x301;mon ldap_cachemgr"></p>
<blockquote>
<p>Fig. 2.5 &#x2013; Le de&#x301;mon ldap_cachemgr</p>
</blockquote>
<p>Au de&#x301;marrage du syste&#x300;me, le processus <em>ldap_cachemgr</em> lit les fichiers <em>ldap_client-file</em> et <em>ldap_client_cred</em> et les met a&#x300; la disposition du client. Ce dernier peut alors utiliser les informations du cache pour se connecter au serveur et acce&#x301;der a&#x300; l&#x2019;annuaire. Le de&#x301;mon <em>ldap_cachemgr</em> est e&#x301;galement charge&#x301; d&#x2019;effectuer les mises a&#x300; jour de la configuration du client. Pour ce faire, a&#x300; intervalles re&#x301;guliers, <em>ldap_cachemgr</em> recherche le profile du client dans l&#x2019;annuaire et ve&#x301;rifie si le profile a&#x300; change&#x301;. Si c&#x2019;est le cas, <em>ldap_cachemgr</em> met a&#x300; jour son cache et le client est automatiquement reconfigure&#x301;.</p>
<p><img src="../images/image_2.6.png" alt="Fig. 2.6 &#x2013; Mise a&#x300; jour automatique"></p>
<blockquote>
<p>Fig. 2.6 &#x2013; Mise a&#x300; jour automatique</p>
</blockquote>
<h1 id="2-5-6-initialisation-manuelle">2.5.6 Initialisation manuelle</h1>
<p>La commande <em>ldapclient</em> appele&#x301;e avec l&#x2019;argument -i permet d&#x2019;initialiser le client LDAP manuellement. Pour configurer de fac&#x327;on minimale le client, l&#x2019;adresse IP du serveur ainsi que le DN de base par de&#x301;faut sont passe&#x301;s a&#x300; <em>ldapclient</em>.</p>
<pre><code>ldapclient -i -b dc=inpres,dc=be 10.59.4.8
</code></pre><p>Invoque&#x301;e avec le parame&#x300;tre <strong>-m</strong>, ldapclient peut modifier la configuration courante du client.</p>
<pre><code>ldapclient -m -d inpres.be -c anonymous -a none
</code></pre><p>Le client e&#x301;tant configure&#x301; manuellement, il est inutile que le de&#x301;mon ldap_cachemgr ra- frai&#x302;chisse automatiquement la configuration du client. La commande suivante e&#x301;vite au de&#x301;mon ldap_cachemgr de rechercher un profile client inexistant.</p>
<pre><code>ldapclient -m -e 0
</code></pre><p>Le parame&#x300;tre <em>ns_ldap_cachettl</em> (cf <a href="">tableau 2.6</a>) vaut maintenant ze&#x301;ro. La commande <code>ldapclient -l</code> permet d&#x2019;afficher la configuration du client.</p>
<pre><code class="lang-apache">ldapclient -l

NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_SERVERS= 10.59.4.8 
NS_LDAP_SEARCH_BASEDN= dc=inpres,dc=be 
NS_LDAP_AUTH= none
NS_LDAP_CREDENTIAL_LEVEL= anonymous

# cat /var/ldap/ldap_client_file
#
# Do not edit this file manually; your changes will be lost.
# Please use ldapclient (1M) instead.
#
NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_SERVERS= 10.59.4.8
NS_LDAP_SEARCH_BASEDN= dc=inpres,dc=be
NS_LDAP_AUTH= none NS_LDAP_CACHETTL= 0
NS_LDAP_CREDENTIAL_LEVEL= anonymous
# cat /var/ldap/ldap_client_cred
$
</code></pre>
<h3 id="2-5-7-v%C3%A9rifier-la-configuration">2.5.7 V&#xE9;rifier la configuration</h3>
<p>La commande <em>ldaplist</em> permet d&#x2019;afficher les informations des diffe&#x301;rents conteneurs de l&#x2019;annuaire. Elle peut e&#x301;galement servir a&#x300; tester la configuration et le bon fonctionnement du client.</p>
<pre><code class="lang-apache"><span class="hljs-keyword">ldaplist</span>

<span class="hljs-keyword">dn</span>: ou=People, dc=inpres,dc=be

<span class="hljs-keyword">dn</span>: ou=Group, dc=inpres,dc=be

<span class="hljs-keyword">dn</span>: ou=Hosts, dc=inpres,dc=be

<span class="hljs-keyword">dn</span>: ou=Profile, dc=inpres,dc=be
</code></pre>
<h3 id="2-5-8-proble%CC%80mes-rencontre%CC%81s">2.5.8 Proble&#x300;mes rencontre&#x301;s</h3>
<p>L&#x2019;initialisation du client Solaris avec un profile stocke&#x301; dans l&#x2019;annuaire pose un pro- ble&#x300;me de compatibilite&#x301; avec le serveur OpenLDAP. En effet, la commande <em>ldapclient</em> ne parvient pas a&#x300; trouver le contexte de nommage de l&#x2019;annuaire. L&#x2019;exemple donne&#x301; plus bas montre les messages d&#x2019;erreur retourne&#x301;s par la commande <em>ldapclient</em> a&#x300; l&#x2019;initialisa- tion du client au moyen d&#x2019;un profile.</p>
<pre><code class="lang-apache"><span class="hljs-keyword">ldapclient</span> -v -P default 10.59.4.8 

<span class="hljs-keyword">Arguments</span> parsed:
             <span class="hljs-keyword">profileName</span>: default
             <span class="hljs-keyword">defaultServerList</span>: 10.59.4.8
<span class="hljs-keyword">Handling</span> init option
<span class="hljs-keyword">About</span> to configure machine by downloading a profile findBaseDN: begins
<span class="hljs-keyword">findBaseDN</span>: Stopping ldap
<span class="hljs-keyword">findBaseDN</span>: calling __ns_ldap_default_config()
<span class="hljs-keyword">found</span> 0 namingcontexts
<span class="hljs-keyword">Cannot</span> find the rootDN
<span class="hljs-keyword">findBaseDN</span>: Err exit
<span class="hljs-keyword">Failed</span> to find defaultSearchBase for domain inpres.be
</code></pre>
<p>La commande <em>ldapclient</em> ne trouve pas de contexte de nommage (found 0 naming- contexts) or l&#x2019;entre&#x301;e <em>rootDSE</em> (voir <a href="">Chapitre 1</a>) de l&#x2019;annuaire contient bien un attribut <em>namingContexts</em>. Un exemple de lecture de cet objet <em>rootDSE</em> est donne&#x301;e ci-dessous.</p>
<pre><code class="lang-apache"><span class="hljs-keyword">ldapsearch</span> -b <span class="hljs-string">&quot;&quot;</span> -s base -h 10.59.4.8 <span class="hljs-string">&quot;(objectClass=*)&quot;</span>
     <span class="hljs-keyword">objectClass</span>=top
     <span class="hljs-keyword">objectClass</span>=OpenLDAProotDSE

<span class="hljs-keyword">ldapsearch</span> -b <span class="hljs-string">&quot;&quot;</span> -s base -h 10.59.4.8 <span class="hljs-string">&quot;(objectClass=*)&quot;</span> +

<span class="hljs-keyword">namingContexts</span>=dc=inpres,dc=be
<span class="hljs-keyword">supportedControl</span>=2.16.840.1.113730.3.4.2
<span class="hljs-keyword">supportedExtension</span>=1.3.6.1.4.1.4203.1.11.1
<span class="hljs-keyword">supportedExtension</span>=1.3.6.1.4.1.1466.20037
<span class="hljs-keyword">supportedFeatures</span>=1.3.6.1.4.1.4203.1.5.1 
<span class="hljs-keyword">supportedLDAPVersion</span>=2 
<span class="hljs-keyword">supportedLDAPVersion</span>=3 
<span class="hljs-keyword">subschemaSubentry</span>=cn=Subschema
</code></pre>
<p>Une premie&#x300;re solution au proble&#x300;me consisterais a&#x300; appliquer un patch a&#x300; la compilation de OpenLDAP afin de rendre compatible le client Solaris et le serveur OpenLDAP. Le patch est donne&#x301; en <a href="">annexe</a> mais son utilisation n&#x2019;a pas e&#x301;te&#x301; teste&#x301;e. Enfin, l&#x2019;autre solution est l&#x2019;initialisation manuelle du client Solaris au moyen de la commande <em>ldapclient</em>.</p>
<p><sup><a href="#fn_9" id="reffn_9">9</a></sup>De&#x301;veloppe&#x301; par Sun, NIS est un service client-serveur pour syste&#x300;mes UNIX permettant de centraliser la gestion des informations d&#x2019;administration comme les mots de passe (fichier <code>/etc/passwd</code>), les noms de machines (<code>/etc/hosts</code>), etc.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../ch2/section4.html" class="navigation navigation-prev " aria-label="Previous page: Tru64"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../ch2/section6.html" class="navigation navigation-next " aria-label="Next page: Linux"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
